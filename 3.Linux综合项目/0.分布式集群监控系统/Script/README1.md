# shell脚本说明
> 该shell脚本分为六个模块，分别是CPU信息获取，内存信息获取，磁盘信息获取，系统概况获取， 用户信息获取，**恶意进程检测**
------
1. **CPU信息获取**
> 输出格式：时间 负载1（1分钟） 负载2（5分钟） 负载3（15分钟） 占用率 （时间间隔0.5） 当前温度 警告（normal，note（50-70），warning（70~））
**注意**：请使用文件获取CPU占用率，不要使用其他命令获取
相关文件：/proc/loadavg
/sys/class/thermal/thermal_zone0/temp
/proc/stat
------
2. **内存信息获取**
> 输出格式

| 时间                 | 总量  | 剩余量 | 当前占用（%） | 占用百分比动态平均值 |
| :------------------- | :---- | :----- | :------------ | :------------------- |
| 2018-01-12__15:00:28 | 1023M | 200M   | 80.4%         | 60.8%                |

> 动态平均值=0.3动态平均值（上一次）+0.7当前占用比
> 在脚本编写过程中，可以参考以下内容：
> awk '{printf("%s %s",$1,$2)}'
> echo "scale=1;0.3*24+0.7*36" | bc
> arry=(a c d e f)
> arry=($1 $2)

------

3. **磁盘信息管理**

> 1. 磁盘总量
> 2. 磁盘剩余量
> 3. 占用比例
>    1. 各分区占用比例
>    2. 各分区总量
>    3. 分区剩余情况
>
> 参考格式：
>
> **2018-01-12__16:48:23 标识（0为整个磁盘，1为分区） 磁盘还是分区（disk| /boot , /） 磁盘/分区总量 磁盘/分区剩余量 占用比例**

------

4. **用户信息获取**

> 参考格式：
>
>  **时间 用户总数（非系统用户）近期活跃用户（3个） 具有ROOT权限用户 当前在线用户_登录IP_TTY** 

**注意：**

>  用户相关的数据都用中括号括起来，每一个元素用逗号分割。 

------

5. **系统运行概况获取**

> 参考格式：
>
> **时间 主机名 OS版本 内核版本 运行时间 平均负载 磁盘总量 磁盘已用% 内存大小 内存已用% CPU温度 磁盘报警级别 内存报警级别 CPU报警级别**

**报警级别：**

|              | normal | note  | warning |
| :----------- | :----- | :---- | :------ |
| 磁盘(百分比) | 0-80   | 80-90 | 90-100  |
| CPU(温度)    | 0-50   | 50-70 | 70-100  |
| MEM(百分比)  | 0-70   | 70-80 | 80-100  |

------

6. **恶意进程检测**

> 1. 在**5s**内如果某一进程的**CPU**或者内存占用超过**50%**，视为恶意进程
> 2. 第一次检测时，获取所有可能的恶意进程
> 3. 如果第一次检测时有潜在恶意进程，等待**5s**继续检测
> 4. 如果潜在恶意进程仍然占超过阈值的资源，视为恶意进程

**输出格式：**

``` shell
2018-09-12__10:31:09 ./2 8400 snowfla+ 99.60% 0.00%
//数据项分别为：时间 进程名 PID 用户 CPU占用 内存占用
```

